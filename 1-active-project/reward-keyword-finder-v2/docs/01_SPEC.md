# 01. 기능 명세서 (SPEC)

> **문서 버전**: 1.0.0
> **최종 수정**: 2025-12-16

---

## 1. 프로그램 목적

**네이버 플레이스 5위 안에 들어가는 키워드를 최대한 많이 찾는 프로그램**

### 1.1 핵심 목표
- MID 또는 URL 입력으로 대상 업체 지정
- 1차 키워드 자동 수집 (place-keywords-maker-v2 연동)
- 5분류 체계 기반 키워드 조합 생성
- 네이버 검색 순위 검증
- 5위 이내 키워드 추출 및 저장

### 1.2 성공 지표
| 지표 | 현재 (V1) | 목표 (V2) |
|------|----------|----------|
| 키워드 후보 수 | 50개 | 200~500개 |
| 작업 시간 | 30분+ | 5분 이내 |
| 자동화율 | 20% | 90% |
| 5위 이내 발견율 | - | 측정 필요 |

---

## 2. 기능 목록

### 2.1 Core Features (핵심 기능)

#### F-C01: MID/URL 입력
```
입력: 네이버 플레이스 URL 또는 MID
출력: 정규화된 MID

지원 URL 형식:
- https://m.place.naver.com/{category}/{MID}/home
- https://map.naver.com/p/entry/place/{MID}
- https://naver.me/xxxxx (단축 URL)

처리 로직:
1. URL에서 MID 추출 (정규식)
2. 단축 URL인 경우 리다이렉트 추적
3. MID 유효성 검증 (숫자 10자리)
```

#### F-C02: 1차 키워드 자동 수집
```
입력: MID
출력: 5분류 키워드 세트

데이터 소스 (place-keywords-maker-v2):
├─ seoKeywords (Apollo State)
├─ votedKeywords (GraphQL API)
├─ representativeKeywords
├─ category
├─ menus
├─ address → LOCATION 키워드
├─ facilities → ATTRIBUTE 키워드
└─ blogReviews → SENTIMENT 키워드

출력 구조:
{
  "CORE": ["미용실", "헤어샵", ...],
  "LOCATION": ["강남역", "역삼동", ...],
  "MENU": ["히피펌", "C컬펌", ...],
  "ATTRIBUTE": ["주차가능", "예약", ...],
  "SENTIMENT": ["친절한", "재방문", ...]
}
```

#### F-C03: 키워드 조합 생성
```
입력: 5분류 키워드 세트
출력: 검증용 키워드 리스트 (50~150개)

조합 규칙: → 02_KEYWORD_RULES.md 참조
- Tier 1: LOCATION + CORE
- Tier 2: LOCATION + ATTRIBUTE + CORE
- Tier 3: LOCATION + SENTIMENT + CORE

필터링:
- 글자수 6~15자
- 중복 제거
- 유사도 높은 키워드 병합
```

#### F-C04: 네이버 순위 검증
```
입력: 키워드 리스트, MID
출력: 순위 정보가 포함된 결과 리스트

검색 URL: https://search.naver.com/search.naver?query={keyword}
파싱 방법: HTML에서 MID 패턴 검색
순위 판정:
- rank ≤ 5: 자연유입
- rank 6~10: 정확매칭
- rank > 10 또는 미발견: 미노출

Rate Limiting:
- 요청 간격: 1~2초
- 최대 동시 요청: 1개
- 실패 시 재시도: 3회 (지수 백오프)
```

#### F-C05: 결과 저장
```
입력: 검증 완료된 결과 리스트
출력: TXT 파일 2개

파일명:
- {MID} 자연유입 추출결과.txt
- {MID} 정확매칭 추출결과.txt

저장 위치: ./결과/
인코딩: UTF-8 with BOM
```

### 2.2 Supporting Features (보조 기능)

#### F-S01: Google Sheets 내보내기
```
입력: 결과 리스트, 스프레드시트 ID
출력: Google Sheets 업데이트

인증: 서비스 계정 (시트.json)
라이브러리: Google.Apis.Sheets.v4
```

#### F-S02: 다중 처리 (배치 모드)
```
입력: MID 리스트 (TXT 파일)
출력: 각 MID별 결과 파일

처리 방식: 순차 처리
진행 상황: 로그 출력
```

#### F-S03: 설정 관리
```
저장 위치: config.json 또는 .env
주요 설정:
- maxKeywordLength: 15
- naturalMatchThreshold: 5
- exactMatchThreshold: 10
- requestDelay: 1500 (ms)
- maxRetries: 3
```

---

## 3. 화면 구성 (UI/UX)

### 3.1 메인 화면
```
┌─────────────────────────────────────────────────────────────────┐
│ [탭: 기본 모드] [탭: 다중 모드] [탭: 설정]                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ 1. 플레이스 URL/MID: [________________________] [MID 추출]      │
│                                                                 │
│ 2. 키워드 수집: [자동 수집] [수동 입력]                          │
│    ├─ CORE:     [미용실, 헤어샵, ...]     (편집 가능)           │
│    ├─ LOCATION: [강남역, 역삼동, ...]     (편집 가능)           │
│    ├─ MENU:     [히피펌, C컬펌, ...]      (편집 가능)           │
│    ├─ ATTRIBUTE:[주차가능, 예약, ...]     (편집 가능)           │
│    └─ SENTIMENT:[친절한, 재방문, ...]     (편집 가능)           │
│                                                                 │
│ 3. 조합 설정:                                                   │
│    ├─ 글자수 제한: [15] 자                                      │
│    ├─ 최대 조합 수: [150] 개                                    │
│    └─ Tier 선택: [x]T1 [x]T2 [ ]T3                              │
│                                                                 │
│ 4. 생성된 조합 미리보기:                                         │
│    ┌──────────────────────────────────────────────────────┐    │
│    │ 강남역 미용실, 역삼동 헤어샵, 강남 히피펌, ...         │    │
│    │ (총 120개)                                            │    │
│    └──────────────────────────────────────────────────────┘    │
│                                                                 │
│ [순위 검증 시작]                                   [결과 저장]   │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│ 진행 상황: [████████░░░░░░░░] 50/120 (41%)                      │
│ 자연유입: 15개 | 정확매칭: 8개 | 미노출: 27개                    │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 결과 화면
```
┌─────────────────────────────────────────────────────────────────┐
│ 검증 결과 (MID: 1421207239)                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ ▼ 자연유입 (5위 이내) - 15개                                    │
│ ┌────────────────────────┬──────┬─────────────────────────┐    │
│ │ 키워드                  │ 순위 │ 조합 패턴               │    │
│ ├────────────────────────┼──────┼─────────────────────────┤    │
│ │ 부산 연산역 미용실      │  2   │ LOC + CORE              │    │
│ │ 연산동 헤어샵           │  3   │ LOC + CORE              │    │
│ │ 부산 연산역 히피펌      │  1   │ LOC + MENU              │    │
│ └────────────────────────┴──────┴─────────────────────────┘    │
│                                                                 │
│ ▼ 정확매칭 (6~10위) - 8개                                       │
│ ┌────────────────────────┬──────┬─────────────────────────┐    │
│ │ 키워드                  │ 순위 │ 조합 패턴               │    │
│ ├────────────────────────┼──────┼─────────────────────────┤    │
│ │ 연산 미용실             │  7   │ LOC + CORE              │    │
│ └────────────────────────┴──────┴─────────────────────────┘    │
│                                                                 │
│ [TXT 저장] [Google Sheets 내보내기] [클립보드 복사]              │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. 비기능 요구사항

### 4.1 성능
- 키워드 수집: 5초 이내
- 조합 생성: 1초 이내
- 순위 검증: 키워드당 2초 (Rate Limiting 포함)
- 전체 프로세스 (100개 키워드): 5분 이내

### 4.2 안정성
- 네트워크 오류 시 자동 재시도 (3회)
- 중간 저장 기능 (검증 중단 시 복구 가능)
- 로깅: 모든 주요 이벤트 기록

### 4.3 확장성
- 새로운 키워드 소스 추가 용이
- 업종별 조합 패턴 설정 가능
- 플러그인 구조로 기능 확장

---

## 5. 제약 사항

### 5.1 기술적 제약
- 네이버 검색 Rate Limiting 준수 필요
- HTML 파싱 방식으로 네이버 UI 변경 시 수정 필요
- place-keywords-maker-v2 의존성

### 5.2 비즈니스 제약
- 네이버 이용약관 준수 (과도한 요청 금지)
- 개인정보 수집 없음

---

*문서 작성: 2025-12-16*
