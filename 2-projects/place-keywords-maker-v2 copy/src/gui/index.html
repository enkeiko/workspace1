<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Place Keywords Maker V2 - Dashboard</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      color: white;
      margin-bottom: 40px;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    .version {
      font-size: 1.2em;
      opacity: 0.9;
    }

    .dashboard {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }

    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: #f7fafc;
      border-radius: 10px;
      margin-bottom: 30px;
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .status-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #48bb78;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .progress-section {
      margin-bottom: 30px;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-weight: 600;
      color: #2d3748;
    }

    .progress-bar {
      width: 100%;
      height: 30px;
      background: #e2e8f0;
      border-radius: 15px;
      overflow: hidden;
      position: relative;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      transition: width 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 10px;
      color: white;
      font-weight: bold;
    }

    .logs {
      background: #1a202c;
      color: #a0aec0;
      padding: 20px;
      border-radius: 10px;
      max-height: 400px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }

    .log-entry {
      padding: 5px 0;
      border-bottom: 1px solid #2d3748;
    }

    .log-timestamp {
      color: #718096;
      margin-right: 10px;
    }

    .log-info { color: #63b3ed; }
    .log-success { color: #48bb78; }
    .log-warning { color: #f6ad55; }
    .log-error { color: #f56565; }

    .controls {
      display: flex;
      gap: 15px;
      margin-top: 30px;
    }

    button {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: #e2e8f0;
      color: #2d3748;
    }

    .btn-secondary:hover {
      background: #cbd5e0;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }

    .stat-value {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .stat-label {
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üöÄ Place Keywords Maker</h1>
      <p class="version">Version 2.0 - Dashboard</p>
    </header>

    <div class="dashboard">
      <div class="status-bar">
        <div class="status-item">
          <div class="status-dot"></div>
          <span>Server Connected</span>
        </div>
        <div class="status-item">
          <span id="server-time">--:--:--</span>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value" id="processed-count">0</div>
          <div class="stat-label">Processed</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="success-count">0</div>
          <div class="stat-label">Success</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="failed-count">0</div>
          <div class="stat-label">Failed</div>
        </div>
      </div>

      <div class="progress-section">
        <div class="progress-header">
          <span>Overall Progress</span>
          <span id="progress-percent">0%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill" style="width: 0%">
            <span id="progress-text"></span>
          </div>
        </div>
      </div>

      <h3 style="margin-bottom: 15px; color: #2d3748;">üìã Live Logs</h3>
      <div class="logs" id="logs">
        <div class="log-entry">
          <span class="log-timestamp">00:00:00</span>
          <span class="log-info">System initialized</span>
        </div>
      </div>

      <div class="controls">
        <button class="btn-primary" onclick="startProcess()">‚ñ∂ Start L1 Pipeline</button>
        <button class="btn-secondary" onclick="clearLogs()">üóëÔ∏è Clear Logs</button>
      </div>
    </div>
  </div>

  <script>
    const eventSource = new EventSource('/events');
    const logsContainer = document.getElementById('logs');
    let processedCount = 0;
    let successCount = 0;
    let failedCount = 0;

    // SSE Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
    eventSource.onmessage = (event) => {
      const data = JSON.parse(event.data);

      if (data.type === 'connected') {
        addLog('Connected to server', 'success');
      } else if (data.type === 'progress') {
        updateProgress(data.progress);
        addLog(data.message, 'info');
        processedCount++;
        document.getElementById('processed-count').textContent = processedCount;
      } else if (data.type === 'success') {
        successCount++;
        document.getElementById('success-count').textContent = successCount;
        addLog(data.message, 'success');
      } else if (data.type === 'error') {
        failedCount++;
        document.getElementById('failed-count').textContent = failedCount;
        addLog(data.message, 'error');
      }
    };

    // ÏßÑÌñâÎ•† ÏóÖÎç∞Ïù¥Ìä∏
    function updateProgress(percent) {
      const fill = document.getElementById('progress-fill');
      const text = document.getElementById('progress-text');
      const percentLabel = document.getElementById('progress-percent');

      fill.style.width = percent + '%';
      text.textContent = percent + '%';
      percentLabel.textContent = percent + '%';
    }

    // Î°úÍ∑∏ Ï∂îÍ∞Ä
    function addLog(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString();
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.innerHTML = `
        <span class="log-timestamp">${timestamp}</span>
        <span class="log-${type}">${message}</span>
      `;

      logsContainer.insertBefore(entry, logsContainer.firstChild);

      // ÏµúÎåÄ 100Í∞ú Î°úÍ∑∏Îßå Ïú†ÏßÄ
      while (logsContainer.children.length > 100) {
        logsContainer.removeChild(logsContainer.lastChild);
      }
    }

    // Î°úÍ∑∏ ÌÅ¥Î¶¨Ïñ¥
    function clearLogs() {
      logsContainer.innerHTML = '';
      addLog('Logs cleared', 'info');
    }

    // ÌîÑÎ°úÏÑ∏Ïä§ ÏãúÏûë
    function startProcess() {
      addLog('Starting L1 Pipeline...', 'info');
      // TODO: API Ìò∏Ï∂úÎ°ú Ïã§Ï†ú ÌîÑÎ°úÏÑ∏Ïä§ ÏãúÏûë
    }

    // ÏÑúÎ≤Ñ ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
    setInterval(() => {
      document.getElementById('server-time').textContent = new Date().toLocaleTimeString();
    }, 1000);
  </script>
</body>
</html>
